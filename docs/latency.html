<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tap Latency Test</title>
    <style>
        :root {
            --bg: #ffffff;
            --fg: #000000;
        }
        body {
            background: var(--bg);
            color: var(--fg);
            font-family: monospace;
            margin: 0;
            padding: 10px;
        }

        .panel { border: 4px solid var(--fg); padding: 15px; }

        button {
            background: var(--bg);
            border: 4px solid var(--fg);
            padding: 15px 25px;
            font-size: 1.2rem;
            font-weight: 900;
            margin-right: 10px;
            cursor: pointer;
        }
        button:active { background: var(--fg); color: var(--bg); }

        #tap-target {
            width: 100%;
            height: 200px;
            border: 4px solid var(--fg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            font-weight: 900;
            user-select: none;
            cursor: pointer;
        }

        #tap-target.tapped {
            background: var(--fg);
            color: var(--bg);
        }

        #latency-results {
            margin-top: 10px;
            font-size: 1rem;
        }

        .back-link {
            display: inline-block;
            margin-bottom: 15px;
            color: var(--fg);
            font-weight: 900;
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">&larr; Back</a>

    <div class="panel">
        <h1>Tap Latency Test</h1>
        <div id="tap-target">TAP HERE</div>
        <div id="latency-results">
            Last: <span id="last-latency">--</span>ms |
            Avg: <span id="avg-latency">--</span>ms |
            Min: <span id="min-latency">--</span>ms |
            Taps: <span id="tap-count">0</span>
        </div>
        <button onclick="resetLatency()" style="margin-top:10px;">Reset Stats</button>
    </div>

    <script>
        const tapTarget = document.getElementById('tap-target');
        let tapStartTime = 0;
        let latencies = [];

        tapTarget.addEventListener('pointerdown', (e) => {
            tapStartTime = performance.now();

            tapTarget.classList.add('tapped');
            tapTarget.textContent = 'TAPPED!';

            const latency = performance.now() - tapStartTime;
            latencies.push(latency);

            document.getElementById('last-latency').textContent = latency.toFixed(1);
            document.getElementById('tap-count').textContent = latencies.length;

            const avg = latencies.reduce((a, b) => a + b, 0) / latencies.length;
            document.getElementById('avg-latency').textContent = avg.toFixed(1);

            const min = Math.min(...latencies);
            document.getElementById('min-latency').textContent = min.toFixed(1);

            e.preventDefault();
        });

        tapTarget.addEventListener('pointerup', () => {
            tapTarget.classList.remove('tapped');
            tapTarget.textContent = 'TAP HERE';
        });

        function resetLatency() {
            latencies = [];
            document.getElementById('last-latency').textContent = '--';
            document.getElementById('avg-latency').textContent = '--';
            document.getElementById('min-latency').textContent = '--';
            document.getElementById('tap-count').textContent = '0';
        }
    </script>
</body>
</html>
